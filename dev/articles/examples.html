<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fitting and Predicting with poissonreg • poissonreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting and Predicting with poissonreg">
<meta name="robots" content="noindex">
<script defer data-domain="poissonreg.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">poissonreg</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/examples.html">Fitting and Predicting with poissonreg</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/poissonreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fitting and Predicting with poissonreg</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/poissonreg/blob/main/vignettes/articles/examples.Rmd" class="external-link"><code>vignettes/articles/examples.Rmd</code></a></small>
      <div class="d-none name"><code>examples.Rmd</code></div>
    </div>

    
    
<p>These examples illustrate which models, engines, and prediction types
are available in poissonreg. As a reminder, in parsnip,</p>
<ul>
<li><p>the <strong>model type</strong> differentiates basic modeling
approaches, such as random forests, proportional hazards models,
etc.,</p></li>
<li><p>the <strong>mode</strong> denotes in what kind of modeling
context it will be used (here: regression), and</p></li>
<li><p>the computational <strong>engine</strong> indicates how the model
is fit, such as with a specific R package implementation or even methods
outside of R like Keras or Stan.</p></li>
</ul>
<p>The following examples use the same data set throughout.</p>
<div class="section level2">
<h2 id="poisson_reg-models">
<code>poisson_reg()</code> models<a class="anchor" aria-label="anchor" href="#poisson_reg-models"></a>
</h2>
<details id="poisson-reg-glm"><summary>
With the <code>"glm"</code> engine
</summary><p>We’ll model the number of articles published by graduate students in
biochemistry Ph.D. programs.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## ── <span style="font-weight: bold;">Attaching packages</span> ───────────────────────────── tidymodels 1.3.0 ──</span></span></code></pre>
<pre><code><span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">broom       </span> 1.0.8     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">rsample     </span> 1.3.0</span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dials       </span> 1.4.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble      </span> 3.2.1</span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr       </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr       </span> 1.3.1</span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">infer       </span> 1.0.8     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tune        </span> 1.3.0</span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">modeldata   </span> 1.4.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflows   </span> 1.2.0</span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">parsnip     </span> 1.3.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflowsets</span> 1.1.0</span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr       </span> 1.0.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">yardstick   </span> 1.3.2</span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">recipes     </span> 1.3.0</span></span></code></pre>
<pre><code><span>  <span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ──────────────────────────────── tidymodels_conflicts() ──</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">discard()</span> masks <span style="color: #0000BB;">scales</span>::discard()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span>  masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>     masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">recipes</span>::<span style="color: #00BB00;">step()</span>  masks <span style="color: #0000BB;">stats</span>::step()</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/poissonreg" class="external-link">poissonreg</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioChemists</span>, package <span class="op">=</span> <span class="st">"pscl"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">biochemists_train</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">biochemists_test</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">pr_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/poisson_reg.html" class="external-link">poisson_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> </span>
<span>  <span class="va">pr_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Poisson Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glm</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span> <span class="op">&lt;-</span> <span class="va">pr_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">art</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">biochemists_train</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  stats::glm(formula = art ~ ., family = stats::poisson, data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Coefficients:</span></span>
<span>  <span class="co">## (Intercept)     femWomen   marMarried         kid5          phd  </span></span>
<span>  <span class="co">##     0.32187     -0.22207      0.14916     -0.18580      0.01003  </span></span>
<span>  <span class="co">##        ment  </span></span>
<span>  <span class="co">##     0.02559  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Degrees of Freedom: 909 Total (i.e. Null);  904 Residual</span></span>
<span>  <span class="co">## Null Deviance:     1800 </span></span>
<span>  <span class="co">## Residual Deviance: 1618    AIC: 3298</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pr_fit</span>, <span class="va">biochemists_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span>  1.96</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span>  1.32</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span>  1.34</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span>  1.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span>  2.23</span></span></code></pre>
</details><details id="poisson-reg-glmnet"><summary>
With the <code>"glmnet"</code> engine
</summary><p>We’ll model the number of articles published by graduate students in
biochemistry Ph.D. programs.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/poissonreg" class="external-link">poissonreg</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioChemists</span>, package <span class="op">=</span> <span class="st">"pscl"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">biochemists_train</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">biochemists_test</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">pr_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/poisson_reg.html" class="external-link">poisson_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> </span>
<span>  <span class="va">pr_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Poisson Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glmnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span> <span class="op">&lt;-</span> <span class="va">pr_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">art</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">biochemists_train</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "poisson") </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##    Df  %Dev  Lambda</span></span>
<span>  <span class="co">## 1   0  0.00 0.59250</span></span>
<span>  <span class="co">## 2   1  1.71 0.53980</span></span>
<span>  <span class="co">## 3   1  3.03 0.49190</span></span>
<span>  <span class="co">## 4   1  4.06 0.44820</span></span>
<span>  <span class="co">## 5   1  4.88 0.40840</span></span>
<span>  <span class="co">## 6   1  5.52 0.37210</span></span>
<span>  <span class="co">## 7   1  6.04 0.33900</span></span>
<span>  <span class="co">## 8   1  6.45 0.30890</span></span>
<span>  <span class="co">## 9   1  6.78 0.28150</span></span>
<span>  <span class="co">## 10  1  7.04 0.25650</span></span>
<span>  <span class="co">## 11  1  7.26 0.23370</span></span>
<span>  <span class="co">## 12  1  7.43 0.21290</span></span>
<span>  <span class="co">## 13  1  7.58 0.19400</span></span>
<span>  <span class="co">## 14  1  7.69 0.17680</span></span>
<span>  <span class="co">## 15  2  7.80 0.16110</span></span>
<span>  <span class="co">## 16  2  7.99 0.14680</span></span>
<span>  <span class="co">## 17  2  8.14 0.13370</span></span>
<span>  <span class="co">## 18  3  8.33 0.12180</span></span>
<span>  <span class="co">## 19  3  8.58 0.11100</span></span>
<span>  <span class="co">## 20  3  8.79 0.10120</span></span>
<span>  <span class="co">## 21  3  8.96 0.09217</span></span>
<span>  <span class="co">## 22  3  9.11 0.08398</span></span>
<span>  <span class="co">## 23  3  9.22 0.07652</span></span>
<span>  <span class="co">## 24  3  9.32 0.06972</span></span>
<span>  <span class="co">## 25  4  9.45 0.06353</span></span>
<span>  <span class="co">## 26  4  9.57 0.05789</span></span>
<span>  <span class="co">## 27  4  9.67 0.05274</span></span>
<span>  <span class="co">## 28  4  9.74 0.04806</span></span>
<span>  <span class="co">## 29  4  9.81 0.04379</span></span>
<span>  <span class="co">## 30  4  9.87 0.03990</span></span>
<span>  <span class="co">## 31  4  9.91 0.03635</span></span>
<span>  <span class="co">## 32  4  9.95 0.03312</span></span>
<span>  <span class="co">## 33  4  9.98 0.03018</span></span>
<span>  <span class="co">## 34  4 10.01 0.02750</span></span>
<span>  <span class="co">## 35  4 10.03 0.02506</span></span>
<span>  <span class="co">## 36  4 10.05 0.02283</span></span>
<span>  <span class="co">## 37  4 10.06 0.02080</span></span>
<span>  <span class="co">## 38  4 10.07 0.01896</span></span>
<span>  <span class="co">## 39  5 10.08 0.01727</span></span>
<span>  <span class="co">## 40  5 10.09 0.01574</span></span>
<span>  <span class="co">## 41  5 10.10 0.01434</span></span>
<span>  <span class="co">## 42  5 10.11 0.01306</span></span>
<span>  <span class="co">## 43  5 10.11 0.01190</span></span>
<span>  <span class="co">## 44  5 10.12 0.01085</span></span>
<span>  <span class="co">## 45  5 10.12 0.00988</span></span>
<span>  <span class="co">## 46  5 10.13 0.00901</span></span>
<span>  <span class="co">## 47  5 10.13 0.00820</span></span>
<span>  <span class="co">## 48  5 10.13 0.00748</span></span>
<span>  <span class="co">## 49  5 10.13 0.00681</span></span>
<span>  <span class="co">## 50  5 10.13 0.00621</span></span>
<span>  <span class="co">## 51  5 10.14 0.00566</span></span>
<span>  <span class="co">## 52  5 10.14 0.00515</span></span>
<span>  <span class="co">## 53  5 10.14 0.00470</span></span>
<span>  <span class="co">## 54  5 10.14 0.00428</span></span>
<span>  <span class="co">## 55  5 10.14 0.00390</span></span>
<span>  <span class="co">## 56  5 10.14 0.00355</span></span>
<span>  <span class="co">## 57  5 10.14 0.00324</span></span>
<span>  <span class="co">## 58  5 10.14 0.00295</span></span>
<span>  <span class="co">## 59  5 10.14 0.00269</span></span>
<span>  <span class="co">## 60  5 10.14 0.00245</span></span>
<span>  <span class="co">## 61  5 10.14 0.00223</span></span>
<span>  <span class="co">## 62  5 10.14 0.00203</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pr_fit</span>, <span class="va">biochemists_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span>  1.67</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span>  1.51</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span>  1.51</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span>  1.49</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span>  2.36</span></span></code></pre>
</details><details id="poisson-reg-hurdle"><summary>
With the <code>"hurdle"</code> engine
</summary><p>We’ll model the number of articles published by graduate students in
biochemistry Ph.D. programs.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/poissonreg" class="external-link">poissonreg</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioChemists</span>, package <span class="op">=</span> <span class="st">"pscl"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">biochemists_train</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">biochemists_test</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">pr_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/poisson_reg.html" class="external-link">poisson_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"hurdle"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> </span>
<span>  <span class="va">pr_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Poisson Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: hurdle</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span> <span class="op">&lt;-</span> <span class="va">pr_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">art</span> <span class="op">~</span> <span class="va">.</span> <span class="op">|</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">biochemists_train</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## pscl::hurdle(formula = art ~ . | ., data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Count model coefficients (truncated poisson with log link):</span></span>
<span>  <span class="co">## (Intercept)     femWomen   marMarried         kid5          phd  </span></span>
<span>  <span class="co">##     0.67114     -0.22858      0.09648     -0.14219     -0.01273  </span></span>
<span>  <span class="co">##        ment  </span></span>
<span>  <span class="co">##     0.01875  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Zero hurdle model coefficients (binomial with logit link):</span></span>
<span>  <span class="co">## (Intercept)     femWomen   marMarried         kid5          phd  </span></span>
<span>  <span class="co">##     0.28643     -0.24805      0.30873     -0.29088      0.01038  </span></span>
<span>  <span class="co">##        ment  </span></span>
<span>  <span class="co">##     0.08317</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pr_fit</span>, <span class="va">biochemists_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span>  2.02</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span>  1.32</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span>  1.31</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span>  1.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span>  2.40</span></span></code></pre>
</details><details id="poisson-reg-stan"><summary>
With the <code>"stan"</code> engine
</summary><p>We’ll model the number of articles published by graduate students in
biochemistry Ph.D. programs.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/poissonreg" class="external-link">poissonreg</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioChemists</span>, package <span class="op">=</span> <span class="st">"pscl"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">biochemists_train</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">biochemists_test</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">pr_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/poisson_reg.html" class="external-link">poisson_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"stan"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> </span>
<span>  <span class="va">pr_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Poisson Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: stan</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span> <span class="op">&lt;-</span> <span class="va">pr_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">art</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">biochemists_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## </span></span>
<span>  <span class="co">## SAMPLING FOR MODEL 'count' NOW (CHAIN 1).</span></span>
<span>  <span class="co">## Chain 1: </span></span>
<span>  <span class="co">## Chain 1: Gradient evaluation took 5.5e-05 seconds</span></span>
<span>  <span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.55 seconds.</span></span>
<span>  <span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span>  <span class="co">## Chain 1: </span></span>
<span>  <span class="co">## Chain 1: </span></span>
<span>  <span class="co">## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 1: </span></span>
<span>  <span class="co">## Chain 1:  Elapsed Time: 0.24 seconds (Warm-up)</span></span>
<span>  <span class="co">## Chain 1:                0.253 seconds (Sampling)</span></span>
<span>  <span class="co">## Chain 1:                0.493 seconds (Total)</span></span>
<span>  <span class="co">## Chain 1: </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SAMPLING FOR MODEL 'count' NOW (CHAIN 2).</span></span>
<span>  <span class="co">## Chain 2: </span></span>
<span>  <span class="co">## Chain 2: Gradient evaluation took 3.6e-05 seconds</span></span>
<span>  <span class="co">## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.36 seconds.</span></span>
<span>  <span class="co">## Chain 2: Adjust your expectations accordingly!</span></span>
<span>  <span class="co">## Chain 2: </span></span>
<span>  <span class="co">## Chain 2: </span></span>
<span>  <span class="co">## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 2: </span></span>
<span>  <span class="co">## Chain 2:  Elapsed Time: 0.24 seconds (Warm-up)</span></span>
<span>  <span class="co">## Chain 2:                0.263 seconds (Sampling)</span></span>
<span>  <span class="co">## Chain 2:                0.503 seconds (Total)</span></span>
<span>  <span class="co">## Chain 2: </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SAMPLING FOR MODEL 'count' NOW (CHAIN 3).</span></span>
<span>  <span class="co">## Chain 3: </span></span>
<span>  <span class="co">## Chain 3: Gradient evaluation took 3.1e-05 seconds</span></span>
<span>  <span class="co">## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.31 seconds.</span></span>
<span>  <span class="co">## Chain 3: Adjust your expectations accordingly!</span></span>
<span>  <span class="co">## Chain 3: </span></span>
<span>  <span class="co">## Chain 3: </span></span>
<span>  <span class="co">## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 3: </span></span>
<span>  <span class="co">## Chain 3:  Elapsed Time: 0.241 seconds (Warm-up)</span></span>
<span>  <span class="co">## Chain 3:                0.324 seconds (Sampling)</span></span>
<span>  <span class="co">## Chain 3:                0.565 seconds (Total)</span></span>
<span>  <span class="co">## Chain 3: </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SAMPLING FOR MODEL 'count' NOW (CHAIN 4).</span></span>
<span>  <span class="co">## Chain 4: </span></span>
<span>  <span class="co">## Chain 4: Gradient evaluation took 3.2e-05 seconds</span></span>
<span>  <span class="co">## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.32 seconds.</span></span>
<span>  <span class="co">## Chain 4: Adjust your expectations accordingly!</span></span>
<span>  <span class="co">## Chain 4: </span></span>
<span>  <span class="co">## Chain 4: </span></span>
<span>  <span class="co">## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span>  <span class="co">## Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span>  <span class="co">## Chain 4: </span></span>
<span>  <span class="co">## Chain 4:  Elapsed Time: 0.229 seconds (Warm-up)</span></span>
<span>  <span class="co">## Chain 4:                0.297 seconds (Sampling)</span></span>
<span>  <span class="co">## Chain 4:                0.526 seconds (Total)</span></span>
<span>  <span class="co">## Chain 4:</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">pr_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## stan_glm</span></span>
<span>  <span class="co">##  family:       poisson [log]</span></span>
<span>  <span class="co">##  formula:      art ~ .</span></span>
<span>  <span class="co">##  observations: 910</span></span>
<span>  <span class="co">##  predictors:   6</span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">##             Median MAD_SD</span></span>
<span>  <span class="co">## (Intercept)  0.3    0.1  </span></span>
<span>  <span class="co">## femWomen    -0.2    0.1  </span></span>
<span>  <span class="co">## marMarried   0.2    0.1  </span></span>
<span>  <span class="co">## kid5        -0.2    0.0  </span></span>
<span>  <span class="co">## phd          0.0    0.0  </span></span>
<span>  <span class="co">## ment         0.0    0.0  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">## * For help interpreting the printed output see ?print.stanreg</span></span>
<span>  <span class="co">## * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pr_fit</span>, <span class="va">biochemists_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 0.674</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 0.271</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 0.289</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 0.371</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 0.800</span></span></code></pre>
</details><details id="poisson-reg-zeroinfl"><summary>
With the <code>"zeroinfl"</code> engine
</summary><p>We’ll model the number of articles published by graduate students in
biochemistry Ph.D. programs.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/poissonreg" class="external-link">poissonreg</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bioChemists</span>, package <span class="op">=</span> <span class="st">"pscl"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">biochemists_train</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">biochemists_test</span> <span class="op">&lt;-</span> <span class="va">bioChemists</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">pr_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/poisson_reg.html" class="external-link">poisson_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"zeroinfl"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> </span>
<span>  <span class="va">pr_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Poisson Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: zeroinfl</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span> <span class="op">&lt;-</span> <span class="va">pr_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">art</span> <span class="op">~</span> <span class="va">.</span> <span class="op">|</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">biochemists_train</span><span class="op">)</span></span>
<span>  <span class="va">pr_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## pscl::zeroinfl(formula = art ~ . | ., data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Count model coefficients (poisson with log link):</span></span>
<span>  <span class="co">## (Intercept)     femWomen   marMarried         kid5          phd  </span></span>
<span>  <span class="co">##    0.637600    -0.205020     0.099136    -0.143444    -0.005037  </span></span>
<span>  <span class="co">##        ment  </span></span>
<span>  <span class="co">##    0.018101  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Zero-inflation model coefficients (binomial with logit link):</span></span>
<span>  <span class="co">## (Intercept)     femWomen   marMarried         kid5          phd  </span></span>
<span>  <span class="co">##    -0.65529      0.12466     -0.35861      0.22921      0.03238  </span></span>
<span>  <span class="co">##        ment  </span></span>
<span>  <span class="co">##    -0.14778</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">pr_fit</span>, <span class="va">biochemists_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span>  2.05</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span>  1.35</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span>  1.32</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span>  1.46</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span>  2.39</span></span></code></pre>
</details>
</div>
  </main>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://frick.ws" class="external-link">Hannah Frick</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
